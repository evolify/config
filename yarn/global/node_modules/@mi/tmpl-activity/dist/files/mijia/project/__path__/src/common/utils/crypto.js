import CryptoJS from 'crypto-js'

function getCryptData(secretKey, secretIv) {
  const key = CryptoJS.enc.Utf8.parse(secretKey)
  const iv = CryptoJS.enc.Utf8.parse(secretIv)

  const options = {
    iv: iv,
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7
  }

  return {
    key,
    options
  }
}

// 加密
export const encrypt = (str, secretKey, secretIv) => {
  const {
    key,
    options
  } = getCryptData(secretKey, secretIv)
  const encrypted = CryptoJS.AES.encrypt(str, key, options).toString()
  return encrypted
}

// 解密
export const decrypt = (encrypted, secretKey, secretIv) => {
  if (!encrypted) {
    return ''
  }

  const {
    key,
    options
  } = getCryptData(secretKey, secretIv)
  let decrypted = CryptoJS.AES.decrypt(encrypted, key, options)
  decrypted = CryptoJS.enc.Utf8.stringify(decrypted) // 转换为 utf8 字符串
  return decrypted
}