import React, { useEffect, useCallback } from "react"
import { usePageTrack, track } from "@mi/miot-track"
import smartHome from "@mi/smarthome-jssdk"
import { Provider, useCtx } from "./api"
// 基础组件
import { toast, Button } from "@mi/fit-ui"
import "./style.scss"

function App(props) {
  const ctx = useCtx()

  console.log(ctx)
  const submit = useCallback(() => {
    toast("提交数据")
    // 打点
    track("key")
  }, [])

  useEffect(() => {
    // 设置分享数据
    smartHome.share.setOption({
      title: "分享标题",
      description: "分享描述",
      url: window.location.href,
      imageUrl: "",
    })
  }, [])

  // 页面曝光打点
  usePageTrack("track_key", {
    // 打点扩展字段
    url: location.href,
  })

  return (
    <div className="page">
      <header className="header"></header>
      <div className="content">小米穿戴活动模板</div>
      <Button onClick={submit}>提交申请</Button>
    </div>
  )
}

export default () => (
  <Provider>
    <App />
  </Provider>
)